# SORT/MERGE JOIN의 사용

- 연결 고리에 인덱스가 전혀 없는 경우
- 대용량의 자료를 조인해야 함으로써 인덱스 사용에 따른
- 랜덤 액세스의 오버헤드가 많은 경우

튜닝포인트

- 각테이블로부터 데이터를 빨리 읽어 들이도록 함
- 각 테이블로부터 읽어 들인 데이터를 조인하기 전에 정렬을 하는데 이러한 정렬 작업을 빨리 끝낼 수 있도록 함



수행절차

- 각 테이블에 대해 동시에 독립적으로 데이터를 먼저 읽어드림 (드라이빙 테이블이없음)
- 읽혀진 각 테이블의 데이터를 조인을 위한 연결 고리에 대하여 정렬을 수행함
- 정렬이 모두 끝난 후에 조인 작업이 수행됨

불리한경우 / 유리한경우

- 그리하여 한쪽이 데이터 적고 한쪽이많을경우 많은쪽이 정렬이 다될때까지 기다리고 둘다 정렬되고나서 조인수행
- 두테이블이 데이타량이 비슷할때 유리
- 두 테이블이 데이터량이 차이가 많이나면 불리
- 데이터가 지나치게 많은경우 (정렬때문에)

장점/단점

- 서로 연결고리에 인덱스가 생성되어 있지 않은 경우에 빠른 조인을 위하여 사용됨

- 각 테이블로부터 읽어 들인 데이터가 크기가 매우 큰 경우 성능상 불리(스캔시간 + 정렬시간)

  



# Hash join해쉬조인

- 해쉬조인은 드라이빙테이블이 있다
- 해쉬조인은 소트머지와 다르게 데이터량이 적은테이블 있더라도 기다리지않고 적은테이블을 먼저 해쉬값을 뽑고 그다음 많은 테이블의 해쉬값을뽑고 해쉬값끼리 조인한다.
- 읽어들인 각 테이블의 데이터를 서로 조인하기 위해 해싱을 이용하여 해시 값을 만든다.
- 해시 값으로 조인을 수행
- 해쉬조인은 메모리사용(HASH_AREA_SIZE) 를 최적화함
- 하드웨어가 좋아야 좋은성능을냄 (CPU, 메모리) -> 반대로말하면 하드웨어가 안좋을땐 성능이 안좋음
- 소트머지조인의 메모리에 2배를 사용한다(디폴트값)



수행절차

- Driving Table 결정
- Driving Table의 연결조건 컬럼 해싱 및 해시 값 생성
- 읽어 들인 데이터와 해싱에서 만들어진 해시 값을 메모리에 저장
- Hash Join이 적용될 테이블의 연결조건 컬럼 해싱 및 해시 값 생성
- 읽어 들인 데이터와 해싱에서 만들어진 해시 값을 메모리에 저장
- 각 테이블에 조인할 데이터가 있는지, 조인하고자 만들었던 해시 값 간에 충돌이 있는지 확인
  - 충돌이 발생할 경우 2차해싱 수행
- 각 테이블의 해시값을 "="로 조인을 수행함